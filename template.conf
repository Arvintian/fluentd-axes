<source>
    @type forward
</source>

{{range $k, $item := .Targets}}
<match {{ $item.target }}>
    @type copy

    <store>
        @type kafka_buffered
        brokers {{ $item.brokers }}
        default_topic {{ $item.topic }}
        <buffer>
            flush_mode interval
            retry_type exponential_backoff
            flush_interval {{ $item.interval }}
        </buffer>
    </store>

</match>
{{end}}

<match **>
    @type stdout
</match>